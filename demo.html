<!DOCTYPE html>
<html>
<head>
    <title>你会陪伴一座城市多久</title>
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://www.hnsjb.cn/static/lib/js/swiper/swiper.min.css">
    <script src="https://www.hnsjb.cn/static/lib/js/swiper/swiper.min.js"></script>
    <script src="https://www.hnsjb.cn/static/lib/js/jquery-1.11.0.js"></script>

</head>
<body>
<div class="loading-line">
    <div class="line"></div>
    <div id="precent" style="text-align: center"></div>
</div>

<div class="swiper-container">
    <div class="swiper-wrapper">
        <div id="page1" class="swiper-slide">
            <div class="autotype" id="autotype">
                <p>你会陪伴一座城市多久？</p>
                <p>5年？</p>
                <p>10年？</p>
                <p>20年？</p>
                <p>30年？</p>
                <p>……</p>
                <p>你匆匆而来</p>
                <p>匆匆而过</p>
                <p>投下路人的一瞥</p>
                <p>“城”</p>
                <p>一直默默承载着你</p>
                <p>“城”</p>
                <p>始终奋力陪你向前</p>
                <p>此刻</p>
                <p>请稍稍放慢脚步</p>
                <p>站在2018回看</p>
                <p>你的“城”</p>
                <p>他的“城”</p>
                <p>我们的“城”</p>
                <p>40年的变化</p>
            </div>
            <div class="arrow-down" style="display: block;"><p>开始</p></div>
        </div>
        <div id="zhengzhou" class="swiper-slide">
            <div class="city-map city-map-zz">
                <p>郑州1978</p>
                <img src="img/zhengzhou01.png" alt="郑州1978">
            </div>
            <div class="city-map city-map-zz">
                <p>郑州2007</p>
                <img src="img/zhengzhou02.png" alt="郑州2007">
            </div>
            <div class="city-map city-map-zz">
                <p>郑州2017</p>
                <img src="img/zhengzhou03.jpg" alt="郑州2017">
            </div>
            <img class="fengmao fengmao1" src="img/27T.png" alt="">
            <img class="fengmao fengmao2" src="img/futa.png" alt="">
            <img class="fengmao fengmao3" src="img/dayumi.png" alt="">
            <img class="fengmao fengmao4" src="img/27T.png" alt="">
            <img class="fengmao fengmao5" src="img/futa.png" alt="">
            <img class="fengmao fengmao6" src="img/dayumi.png" alt="">
            <div class="arrow-down" style="display: block;"><p>切换城市</p></div>
        </div>
        <div id="luoyang" class="swiper-slide">
            <div class="city-map city-map-ly">
                <p>洛阳1972</p>
                <img src="img/luoyang01.png" alt="洛阳1972">
            </div>
            <div class="city-map city-map-ly">
                <p>洛阳2007</p>
                <img src="img/luoyang02.png" alt="洛阳2007">
            </div>
            <div class="city-map city-map-ly">
                <p>洛阳2017</p>
                <img src="img/luoyang03.jpg" alt="洛阳2017">
            </div>
            <img class="fengmao fengmao1" src="img/27T.png" alt="">
            <img class="fengmao fengmao2" src="img/futa.png" alt="">
            <img class="fengmao fengmao3" src="img/dayumi.png" alt="">
            <img class="fengmao fengmao4" src="img/27T.png" alt="">
            <img class="fengmao fengmao5" src="img/futa.png" alt="">
            <img class="fengmao fengmao6" src="img/dayumi.png" alt="">
            <div class="arrow-down" style="display: block;"><p>切换城市</p></div>
        </div>
        <div id="kaifeng" class="swiper-slide">
            <div class="city-map city-map-kf">
                <p>开封1978</p>
                <img src="img/kaifeng01.png" alt="开封1978">
            </div>
            <div class="city-map city-map-kf">
                <p>开封2007</p>
                <img src="img/kaifeng02.png" alt="开封2007">
            </div>
            <div class="city-map city-map-kf">
                <p>开封2017</p>
                <img src="img/kaifeng03.png" alt="开封2017">
            </div>
            <img class="fengmao fengmao1" src="img/27T.png" alt="">
            <img class="fengmao fengmao2" src="img/futa.png" alt="">
            <img class="fengmao fengmao3" src="img/dayumi.png" alt="">
            <img class="fengmao fengmao4" src="img/27T.png" alt="">
            <img class="fengmao fengmao5" src="img/futa.png" alt="">
            <img class="fengmao fengmao6" src="img/dayumi.png" alt="">
            <div class="arrow-down" style="display: block;"><p>切换城市</p></div>
        </div>
        <div id="pingdingshan" class="swiper-slide">
            <div class="city-map city-map-pds">
                <p>开封1986</p>
                <img src="img/kaifeng01.png" alt="开封1986">
            </div>
            <div class="city-map city-map-pds">
                <p>开封2007</p>
                <img src="img/kaifeng02.png" alt="开封2007">
            </div>
            <div class="city-map city-map-pds">
                <p>开封2017</p>
                <img src="img/kaifeng03.png" alt="开封2017">
            </div>
            <img class="fengmao fengmao1" src="img/27T.png" alt="">
            <img class="fengmao fengmao2" src="img/futa.png" alt="">
            <img class="fengmao fengmao3" src="img/dayumi.png" alt="">
            <img class="fengmao fengmao4" src="img/27T.png" alt="">
            <img class="fengmao fengmao5" src="img/futa.png" alt="">
            <img class="fengmao fengmao6" src="img/dayumi.png" alt="">
            <div class="arrow-down" style="display: block;"><p>切换城市</p></div>
        </div>
        <div id="anyang" class="swiper-slide">
            <div class="city-map city-map-ay">
                <p>安阳1984</p>
                <img src="img/anyang01.png" alt="安阳1984">
            </div>
            <div class="city-map city-map-ay">
                <p>安阳2007</p>
                <img src="img/anyang02.png" alt="安阳2007">
            </div>
            <div class="city-map city-map-ay">
                <p>安阳2017</p>
                <img src="img/anyang03.jpg" alt="安阳2017">
            </div>
            <img class="fengmao fengmao1" src="img/27T.png" alt="">
            <img class="fengmao fengmao2" src="img/futa.png" alt="">
            <img class="fengmao fengmao3" src="img/dayumi.png" alt="">
            <img class="fengmao fengmao4" src="img/27T.png" alt="">
            <img class="fengmao fengmao5" src="img/futa.png" alt="">
            <img class="fengmao fengmao6" src="img/dayumi.png" alt="">
            <div class="arrow-down" style="display: block;"><p>切换城市</p></div>
        </div>
        <div id="page7" class="swiper-slide">
            <p>12月24日至28日</p>
            <p>报业大厦</p>
            <p>“城”就河南</p>
            <p>河南城市发展地图展</p>
            <p>和河南手机报一起</p>
            <p>回想</p>
            <p>你与“城”的</p>
            <p>出彩故事</p>
            <p>为河南城区40年之变化</p>
            <p>添彩</p>
        </div>
    </div>
</div>
<script>
	var imgArr = [
		'img/page1.jpg',
		'img/bg1.jpg',
		'img/zhengzhou01.png',
		'img/zhengzhou02.png',
		'img/zhengzhou03.jpg',
		'img/zhengzhouall.jpg',
		'img/luoyang01.png',
		'img/luoyang02.png',
		'img/luoyang03.jpg',
		'img/luoyangall.jpg',
		'img/kaifeng01.png',
		'img/kaifeng02.png',
		'img/kaifeng03.png',
		'img/kaifengall.jpg',
		'img/pingdingshan01.png',
		'img/pingdingshan02.png',
		'img/pingdingshan03.jpg',
		'img/pingdingshanall.jpg',
		'img/anyang01.png',
		'img/anyang02.png',
		'img/anyang03.jpg',
		'img/anyangall.jpg'
	];
	var newimages = [], loadedimages = 0;

	function preloadimages(arr) {
		var arr = (typeof arr != "object") ? [arr] : arr;

		function imageloadpost() {
			loadedimages++;
			if (loadedimages == arr.length) {
				$('#precent').text('100%');
				$('.line').css('width', '100%');
				setTimeout(function () {
					document.getElementsByClassName('swiper-container')[0].style.opacity = 1;
					document.getElementsByClassName('loading-line')[0].style.display = 'none';
				}, 500);
			} else {
				$('#precent').text((loadedimages / arr.length).toFixed(2) * 100 + '%');
				$('.line').css('width', (loadedimages / arr.length).toFixed(2) * 100 + '%')
			}
		}

		for (var i = 0; i < arr.length; i++) {
			newimages[i] = new Image();
			newimages[i].src = arr[i];
			newimages[i].onload = function () {
				imageloadpost()
			};
			newimages[i].onerror = function () {
				imageloadpost()
			}
		}
	}

	preloadimages(imgArr);
</script>
<script>
	var fengmaoTimer;
	function showFengmao(index) {
		fengmaoTimer = setTimeout(function () {
			$($('.fengmao1')[index])
				.css({top: '50px', 'left': 0, 'opacity': 0, 'width': '50px', height: '200px'})
				.animate({top: '50px', left: '50%', opacity: '1'}, 1000, function () {
					$($('.fengmao2')[index])
						.css({top: '50px', 'right': 0, 'opacity': 0, 'width': '50px', height: '200px'})
						.animate({right: '50px', opacity: '11'}, 1000, function () {
							$($('.fengmao3')[index])
								.css({top: '50px', 'left': 0, 'opacity': 0, 'width': '50px', height: '200px'})
								.animate({top: '50px', left: '50px', opacity: '1'}, 1000, function () {
									$($('.fengmao1')[index]).animate({top: '200px', width: '25px', height: '100px'});
									$($('.fengmao2')[index]).animate({top: '200px', width: '25px', height: '100px'});
									$($('.fengmao3')[index]).animate({top: '200px', width: '25px', height: '100px'});
								});
						});

				});
			$($('.fengmao4')[index])
				.css({bottom: '50px', 'left': 0, 'opacity': 0, 'width': '50px', height: '200px'})
				.animate({bottom: '50px', left: '50%', opacity: '1'}, 1000, function () {
					$($('.fengmao5')[index])
						.css({bottom: '50px', 'right': 0, 'opacity': 0, 'width': '50px', height: '200px'})
						.animate({bottom: '50px', right: '50px', opacity: '1'}, 1000, function () {
							$($('.fengmao6')[index])
								.css({bottom: '50px', 'left': 0, 'opacity': 0, 'width': '50px', height: '200px'})
								.animate({bottom: '50px', left: '50px', opacity: '1'}, 1000, function () {
									$($('.fengmao4')[index]).animate({bottom: '200px', width: '25px', height: '100px'});
									$($('.fengmao5')[index]).animate({bottom: '200px', width: '25px', height: '100px'});
									$($('.fengmao6')[index]).animate({bottom: '200px', width: '25px', height: '100px'});
								});
						});

				});
		}, 15000);
	}
	var swiper = new Swiper('.swiper-container', {
		direction: 'vertical',
		on: {
			slideChangeTransitionStart: function () {
				clearTimeout(fengmaoTimer);

				if (this.activeIndex === 1) {
					$('.city-map').removeClass('zz1').removeClass('zz2').removeClass('zz3');
					$($('.city-map-zz')[0]).show().addClass('zz1');
					$($('.city-map-zz')[1]).show().addClass('zz2');
					$($('.city-map-zz')[2]).show().addClass('zz3');
					showFengmao(this.activeIndex - 1)
				} else if (this.activeIndex === 2) {
					$('.city-map').removeClass('zz1').removeClass('zz2').removeClass('zz3');
					$($('.city-map-ly')[0]).show().addClass('zz1');
					$($('.city-map-ly')[1]).show().addClass('zz2');
					$($('.city-map-ly')[2]).show().addClass('zz3');
					showFengmao(this.activeIndex - 1)
				} else if (this.activeIndex === 3) {
					$('.city-map').removeClass('zz1').removeClass('zz2').removeClass('zz3');
					$($('.city-map-kf')[0]).show().addClass('zz1');
					$($('.city-map-kf')[1]).show().addClass('zz2');
					$($('.city-map-kf')[2]).show().addClass('zz3');
					showFengmao(this.activeIndex - 1)
				} else if (this.activeIndex === 4) {
					$('.city-map').removeClass('zz1').removeClass('zz2').removeClass('zz3');
					$($('.city-map-pds')[0]).show().addClass('zz1');
					$($('.city-map-pds')[1]).show().addClass('zz2');
					$($('.city-map-pds')[2]).show().addClass('zz3');
					showFengmao(this.activeIndex - 1)
				} else if (this.activeIndex === 5) {
					$('.city-map').removeClass('zz1').removeClass('zz2').removeClass('zz3');
					$($('.city-map-ay')[0]).show().addClass('zz1');
					$($('.city-map-ay')[1]).show().addClass('zz2');
					$($('.city-map-ay')[2]).show().addClass('zz3');
					showFengmao(this.activeIndex - 1)
				} else if (this.activeIndex === 6) {

					$("#page7").autotype();
				}
			}
		}
	});

</script>
<script>
	$.fn.autotype = function () {
		var $text = $(this);
		console.log('this', this);
		var str = $text.html(); //返回被选 元素的内容
		var index = 0;
		var x = $text.html('');
		//$text.html()和$(this).html('')有区别
		var timer = setInterval(function () {
				//substr(index, 1) 方法在字符串中抽取从index下标开始的一个的字符
				var current = str.substr(index, 1);
				if (current == '<') {
					//indexOf() 方法返回">"在字符串中首次出现的位置。
					index = str.indexOf('>', index) + 1;
				} else {
					index++;
				}
				//console.log(["0到index下标下的字符",str.substring(0, index)],["符号",index & 1 ? '_': '']);
				//substring() 方法用于提取字符串中介于两个指定下标之间的字符
				$text.html(str.substring(0, index) + (index & 1 ? '_' : ''));
				if (index >= str.length) {
					clearInterval(timer);
				}
			},
			50);
	};
	$("#autotype").autotype();
</script>
</body>
</html>